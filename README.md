# Предсказание оттока клиентов оператора связи (ЯП)

### Цели проекта  

- Спрогнозировать отток клиентов мобильного оператора для планирования предупредительных предварительных мер (скидок, особых условий).  
Для выборки клиентов доступны персональные данные, информация о тарифах и договорах.  
- Построить модель со значением метрики качества ROC_AUC не меньше 0.88.  
Дополнительно зафиксировать accuracy модели.  

### План работы

__Подготовить данные для анализа__

    - проверить наличие неявных пропусков,
    - выявить явные и неявные дубликаты,
    - проверить верный формат ввода данных, привести их к соответствующему типу,
    - привести все к единообразному виду, собрав в единую таблицу,
    - провести анализ полученных объединенных данных,
    - выделить целевой признак, отражающий факт ухода клиента или продолжения взаимодействия с компанией.

__Провести анализ__

    - посмотреть на распределение целевого признака,
    - посмотреть на колличественные признаки,
    - посмотреть на распределение типов услуг между теми, кто ушел, и теми, кто продолжает получать услуги компании,
    - посмотреть на распределение типа оплаты услуг между теми, кто ушел, и теми, кто продолжает получать услуги компании.
    
__Обучить и протестировать модель__

    - подготовить данные к обучению модели с помощью кодирования и разбивки на обучающую и тестовую выборку
    - выбрать модели для обучения
    - посмотреть на качество моделей по скорости обучения модели и качеству на основе выбранных метрик (ROC AUC),
    - выбрать лучшую модель и посмотреть на финальную оценку по выбранным метрикам.
    
__Подготовить отчет__

    - подготовить отчет по результатом работы с подведением выводов и рекомендациями в соответствии с полученными данным по результатам работы модели.  

### Итоги

Проведён анализ признаков и выявлены следующие инсайты.  
    - в среднем ушедшие клиенты платили в месяц больше, чем оставшиеся  
    - среди клиентов, не пользовавшихся услугами интернета, отток сравнительно небольшой  

Для обучения были выбраны четыре модели: LogisticRegression, DecisionTree, RandomForest и CatBoostClassifier.
Лучшие результаты на обучающей выборке показала модель CatBoostClassifier.
Лучшими гиперпараметрами оказались:
* 'border_count': 128
* 'learning_rate': 0.1
* 'max_depth': 5
* 'n_estimators': 300

На тестовой выборке данная модель показала результаты:

* ROC AUC: 0.9232894010911543
* Accuracy: 0.919226393629124

Матрица ошибок показала, что модель успешно предсказывает случаи продолжения сотрудничества клиента с компанией и несколько хуже - случаи ухода клиента.
Ключевыми признаками оказались продолжительность сотрудничества клиента и величина ежемесячного платежа.

В целом, можно утверждать, что представленная модель достигает результатов, поставленых заказчиком проекта.

### Используемый стек инструментов

- Python
- Pandas
- NumPy
- scikit-learn
- CatBoost
- Phi_K
- Matplotlib
- Seaborn
- Jupyter Notebook